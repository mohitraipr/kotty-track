<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manage Categories - Kotty Track</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #f8f9fa; padding: 20px; }
    .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; }
    .btn-primary { background: #2563eb; border: none; }
    .btn-secondary { background: #6c757d; border: none; }
  </style>
</head>
<body>
  <div class="container">
    <div class="d-flex justify-content-between mb-4">
      <h2><i class="bi bi-list-check"></i> Manage Categories</h2>
      <a href="/operator/dashboard" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Back</a>
    </div>
    <div class="mb-4">
      <h5>Add New Category</h5>
      <form id="addCategoryForm" class="row g-3">
        <div class="col-md-4">
          <input type="text" class="form-control" id="name" placeholder="Category Name (e.g., MENSJEANS)" required>
        </div>
        <div class="col-md-6">
          <input type="text" class="form-control" id="description" placeholder="Description">
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-primary w-100"><i class="bi bi-plus"></i> Add</button>
        </div>
      </form>
    </div>
    <table class="table table-striped">
      <thead>
        <tr><th>Name</th><th>Description</th><th>Active</th></tr>
      </thead>
      <tbody>
        <% categories.forEach(cat => { %>
          <tr>
            <td><strong><%= cat.name %></strong></td>
            <td><%= cat.description || '-' %></td>
            <td><span class="badge bg-<%= cat.is_active ? 'success' : 'secondary' %>"><%= cat.is_active ? 'Active' : 'Inactive' %></span></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
  <script>
    document.getElementById('addCategoryForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      try {
        const response = await fetch('/po-creator/operator/api/add-category', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            name: document.getElementById('name').value,
            description: document.getElementById('description').value
          })
        });
        if (response.ok) {
          alert('Category added successfully!');
          location.reload();
        } else {
          const data = await response.json();
          alert('Error: ' + (data.error || 'Failed to add category'));
        }
      } catch (error) {
        alert('Error: ' + error.message);
      }
    });
  </script>
</body>
</html>